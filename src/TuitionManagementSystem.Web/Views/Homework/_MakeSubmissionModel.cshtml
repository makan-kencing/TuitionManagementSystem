@model TuitionManagementSystem.Web.Features.Homework.MakeSubmissionViewModel

<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content shadow-lg border-0">


        <div class="modal-header bg-light">
            <h5 class="modal-title fw-semibold">
                Submit Homework
            </h5>
            <button type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"></button>
        </div>

        <div class="modal-body">

            <form id="make-submission"
                  hx-post
                  hx-controller="Homework"
                  hx-action="MakeSubmission">

                <input type="hidden" asp-for="AssignmentId"/>

                <div class="mb-3">
                    <label asp-for="Content" class="form-label fw-semibold">
                        Submission Content
                    </label>
                    <textarea asp-for="Content"
                              class="form-control"
                              rows="5"
                              placeholder="Write your answer or explanation here..."></textarea>
                </div>

                <div id="file-list"
                     class="border rounded p-2 small bg-light">
                    <span class="text-muted">No files uploaded yet</span>
                </div>
            </form>


            <div class="mt-4 border-top pt-3">
                <h6 class="fw-semibold mb-2">📎 Attach Files</h6>

                <form id="file-form"
                      hx-post
                      hx-controller="File"
                      hx-action="Upload"
                      hx-target="#file-list"
                      hx-swap="beforeend"
                      hx-encoding="multipart/form-data"
                      class="d-flex align-items-center gap-2">

                    <input type="file"
                           name="files"
                           class="form-control form-control-sm"/>

                    <button type="submit"
                            class="btn btn-outline-primary btn-sm">
                        Upload
                    </button>
                </form>

                <progress id="progress"
                          class="w-100 mt-2"
                          value="0"
                          max="100"></progress>
            </div>

            <script>
                htmx.on('#file-form', 'htmx:xhr:progress', function (event) {
                    const progress = htmx.find('#file-form #progress');
                    if (!progress) return;

                    progress.setAttribute(
                        'value',
                        event.detail.loaded / event.detail.total * 100
                    );
                });
            </script>

        </div>


        <div class="modal-footer bg-light">
            <button type="button"
                    class="btn btn-outline-secondary"
                    data-bs-dismiss="modal">
                Cancel
            </button>

            <button type="submit"
                    class="btn btn-danger px-4"
                    form="make-submission">
                Submit
            </button>
        </div>
    </div>
</div>
